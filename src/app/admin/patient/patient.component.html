<div class="container-fluid registrationform">
    <form [formGroup]="patientRegistrationForm">
        <div class="patient mt-2">
            <h1 class="m-0">Patient Registration</h1>
            <div class="button-group">
                <div class=" mt-2 mr-2">
                    <mat-form-field class="example-full-width">
                        <input type="text" placeholder="Search  By Name or PID" aria-label="Number" matInput
                            [formControl]="myControl" (keyup)="getpatients($event)" [matAutocomplete]="auto">
                        <!-- (keyup)="checkPin($event)"  -->
                        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete"
                            (optionSelected)="onFileChange($event.option.value)">
                            <mat-option *ngFor="let option of options" [value]="option.pid" multiple>
                                {{option?.name}} {{option?.mobileNumber}} {{option?.pid}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
                <button class=" btn-primary mr-2" (click)="printForm('printform')" hidden></button>
                <button class=" btn-primary mr-2" (click)="print('print')" *ngIf="!patientdetailsdata?.pid">Print
                    Form</button>
                <!-- <button class=" btn-primary mr-2" *ngIf="patientdetailsdata?.pid"  (click)="printForm('printform')"
                    ngxPrintItemButton className="printident" hidden></button> -->
                <button class=" btn-primary mr-2" *ngIf="patientdetailsdata?.pid" (click)="printForm('reprintform')"
                    ngxPrintItemButton className="printident">Reprint Form</button>
                <button class=" btn-primary mr-2" *ngIf="patientdetailsdata?.pid" printSectionId="print-barcode"
                     ngxPrint >Print
                    Barcode</button>
                    <!-- <button class=" btn-primary mr-2" *ngIf="patientdetailsdata?.pid" 
                    >Print
                    Barcode</button> -->
                <button class=" btn-primary mr-2" printSectionId="print-questionnaire" [useExistingCss]="true"
                    ngxPrint>Print Questionnaire</button>
                <!-- <button class=" btn-primary mr-2" *ngIf="patientdetailsdata?.pid" (click)="printForm('reprintform')" >Reprint Form</button> -->

                <!-- printSectionId="printform" [useExistingCss]="true"  ngxPrint  (click)="printForm()"-->
                <button class=" btn-primary mr-2" *ngIf="patientdetailsdata?.pid"
                    (click)="onChangeForm('Questionnaire')">{{ showQuestioner === false ? "Questionnaire" :
                    "RegisterForm"}}</button>
                <button class=" btn-primary mr-2" *ngIf="patientdetailsdata?.pid"
                    (click)="onChangeForm('Upload Tests')">{{ showUploadFiles === false ? "Upload Reports" :
                    "RegisterForm"}}</button>
            </div>
        </div>

        <div *ngIf="!showQuestioner && !showUploadFiles">
            <div class="card bg-light">
                <div class="card-body">
                    <div class="card p-3">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label for="">PID</label>
                                    <button class="btn-btn-primary scanButton" (click)="sacnEanble()" type="submit"
                                        id="pid-b" *ngIf="!hideScannerbutton">Scan</button>
                                    <input class="form-control" formControlName="PID" [attr.disabled]="disbalePIDInput"
                                        #search>
                                </div>
                                <div class="form-group">
                                    <label for="">Patient Name</label>
                                    <input class="form-control" formControlName="name"
                                    [ngClass]="{ 'is-invalid': submitted && f.name.errors }"
                                    >
                                    <div *ngIf="submitted && f.name.errors" class="invalid-feedback">
                                        <div *ngIf="f.name.errors.required">Please enter name</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div >
                                <div class="form-group"  [ngClass]="{'visiable':patientdetailsdata?.createdAt , 'visiableNone':!patientdetailsdata?.createdAt}">
                                    <label for="">REG. Date</label>
                                    <input class="form-control" disabled
                                        [value]="patientdetailsdata?.createdAt | date:'dd-MM-yyyy HH:mm'">
                                </div>
                            </div>
                                    <div class="form-group">
                                        <label>Gender</label>
                                        <select class="form-control" formControlName="gender" [ngClass]="{ 'is-invalid': submitted && f.gender.errors }" required>
                                            <option value="" disabled>Select Gender</option>
                                            <option value="male">Male</option>
                                            <option value="female">Female</option>
                                            <option value="other">Other</option>
                                        </select>
                                        <div *ngIf="submitted && f.gender.errors" class="invalid-feedback">
                                            <div *ngIf="f.gender.errors.required">:Please Select a Gender</div>
                                        </div>
                                    </div>
                                <!-- <p *ngIf="patientdetailsdata?.createdAt">Date:{{patientdetailsdata?.createdAt | date:'dd-MM-yyyy'}}</p> -->
                            </div>
                            <div class="col-lg-3">
                                <div class="qr-code border-success">
                                    <label>Bar Code</label>
                                    <ngx-barcode [bc-value]="value" [bc-display-value]="true"></ngx-barcode>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <!-- <div class="qr-code border-success">
                                <label class="d-block">QR Code</label>
                                <ngx-qrcode    [elementType]="'svg'" 
                                [value] = "value"
                                cssClass = "aclass"
                                [width]="120"
                                errorCorrectionLevel = "L">
                                </ngx-qrcode>
                            </div> -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="qr-code border-success">
                                            <label>QR Code</label>
                                            <!-- <qrcode 
                                        [qrdata]="barCodeValue" [width]="150"  [errorCorrectionLevel]="'M'" [elementType]="'svg'" *ngIf="barCodeValue"
                                        ></qrcode> -->
                                        <qrcode [qrdata]="value" [width]="120" [errorCorrectionLevel]="'M'"></qrcode>
                                            <!-- <ngx-qrcode [elementType]="'svg'" [value]="value" cssClass="aclass"
                                                [width]="120" errorCorrectionLevel="L">
                                            </ngx-qrcode> -->
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <img src="../../../assets/PreviaLogo.png" class="img-responsive img-fluid">
                                        <!-- <img [src]="sanitizer.bypassSecurityTrustUrl('/' + cardModel[r.content].value)" /> -->
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="form-group">
                                    <label>DOB</label>
                                    <input type="date" class="form-control" formControlName="DOB"
                                        (change)="onDateChange($event)">
                                </div>
                            </div>
                            <div class="col-lg-1">
                                <div class="form-group">
                                    <label>Age</label>
                                    <input type="text" class="form-control" [(ngModel)]="age"
                                        [ngModelOptions]="{standalone: true}" disabled>
                                </div>
                            </div>
                            
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>Mobile</label>
                                    <input type="text" class="form-control" formControlName="mobileNumber" required
                                        [ngClass]="{ 'is-invalid': submitted && f.mobileNumber.errors }" max="10" min="10" required pattern="^[0-9]\d{9}$" (keypress)="checkIfNumber($event)">
                                    <div *ngIf="submitted && f.mobileNumber.errors" class="invalid-feedback" (input)="patientDynamicFormValidation()" required>
                                        <div *ngIf="f.mobileNumber.errors.required">MobileNumber must be a valid MobileNumber</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="text" class="form-control" formControlName="emailAddress"
                                    [ngClass]="{ 'is-invalid': submitted && f.emailAddress.errors }"
                                    (input)="patientDynamicFormValidation()">
                                    <div *ngIf="submitted && f.emailAddress.errors" class="invalid-feedback">
                                        <div *ngIf="f.emailAddress.errors.required">Email must be a valid email address</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label>Proof Details</label>
                                    <div class="input-flex">
                                        <ng-select formControlName="proofType" >
                                            <ng-option value="" disabled>Select Proof</ng-option>
                                            <ng-option value='voter'>Voter Id</ng-option>
                                            <ng-option value='passport'>PassPort ID</ng-option>
                                            <ng-option value='license'>License</ng-option>
                                        </ng-select>
                                        <input type="text"  class="form-control" placeholder="Enter Id No" formControlName="proofValue">
                                    </div>
                                    <!-- <div *ngIf="submitted && f.aadhaar.errors" class="invalid-feedback">
                                        <div *ngIf="f.aadhaar.errors.required" >Please enter valid  Aadhar</div>
                                    </div> -->
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>Aadhar</label>
                                    <input type="text" class="form-control" formControlName="aadhaar" 
                                    [ngClass]="{ 'is-invalid': submitted && f.aadhaar.errors }" 
                                    required (input)="patientDynamicFormValidation()">
                                    <div *ngIf="submitted && f.aadhaar.errors" class="invalid-feedback">
                                        <div *ngIf="f.aadhaar.errors.required" >Please enter valid  Aadhar</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>Economic Status</label>  
                                    <input type="text" class="form-control" formControlName="economicStatus">
                                </div>
                            </div>

                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>Occupation</label>
                                    <input type="text" class="form-control" formControlName="occupation">
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>Address</label>
                                    <input type="text" class="form-control" formControlName="address">
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>City</label>
                                    <input type="text" class="form-control" formControlName="city">
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label>State</label>
                                    <input type="text" class="form-control" formControlName="state">
                                </div>
                            </div>
                            <div class="col-lg-5">
                                <div class="form-group">
                                    <label>Habits</label>
                                    <textarea class="form-control" formControlName="habits"></textarea>
                                </div>
                            </div>
                            <div class="col-lg-5">
                                <div class="form-group">
                                    <label>LifeStyle</label>
                                    <textarea type="text" class="form-control" formControlName="lifeStyle"></textarea>
                                </div>
                            </div>
                            <div class="col-lg-2">
                                <div class="form-group">
                                    <label class="mb-3">Default Test package</label>
                                    <mat-checkbox  class="defaultCheckBox" (change)="selectDefaultTestPackages($event)" [checked]="isDefaultTestPackage">
                                        Default Test package</mat-checkbox>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card p-3 my-3">
                <div class="progress-bar-icons ">
                    <ul>
                        <li [ngClass]="{'active': patientaccshow === 'patient'}">
                            <span>Patient</span>
                            <p class="active"></p>
                        </li>
                        <li [ngClass]="{'active': testaccshow === 'test'}">
                            <span>Tests</span>
                            <p class="active"></p>
                        </li>
                        <li [ngClass]="{'active': pastaccshow === 'past'}">
                            <span>Past Medic History</span>
                            <p class="active"></p>
                        </li>
                        <li [ngClass]="{'active': familyaccshow === 'family'}">
                            <span>Family History</span>
                            <p class="active"></p>
                        </li>
                        <li [ngClass]="{'active': doctorReviewshow === 'doctorReview'}">
                            <span>Doctor Review</span>
                            <p class="active"></p>
                        </li>
                        <li [ngClass]="{'active': questionnaireshow === 'questionnaireView'}"
                            *ngIf="showQuestionnaireView">
                            <span>Questionnaire</span>
                            <p class="active"></p>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="card mt-3 bg-light">
                <div class="card-body">
                    <div class="">
                        <mat-accordion class="example-headers-align mt-2" multi>
                            <mat-expansion-panel>
                                <mat-expansion-panel-header (click)="accordian('patient')">
                                    <mat-panel-title>
                                        Patient
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div class="table-responsive details" formGroupName="details">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Height(cms)</th>
                                                <th>Weight(Kgs)</th>
                                                <th>BMi</th>
                                                <th>Blood Presure</th>
                                                <th>Acuity Of Vision</th>
                                                <th>Blood Group</th>
                                                <th>Temperature (°F)</th>
                                                <th>comment</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><input type="text" class="form-control" formControlName="height"
                                                        placeholder="Value"></td>
                                                <td><input type="text" class="form-control" formControlName="weight"
                                                        placeholder="Value"></td>
                                                <td><input type="text" class="form-control" formControlName="BMI"
                                                        placeholder="Value"></td>
                                                <td><input type="text" class="form-control" formControlName="BP"
                                                        placeholder="Value"></td>
                                                <td><input type="text" class="form-control"
                                                        formControlName="acuityOfVision" placeholder="Value"></td>
                                                <td><input type="text" class="form-control" formControlName="bloodGroup"
                                                        placeholder="Value"></td>
                                                <td><input type="text" class="form-control"
                                                        formControlName="temperature" placeholder="Value"></td>
                                                <td><input type="text" class="form-control" formControlName="comment"
                                                        placeholder="Value"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <h3 *ngIf="patientdetailsdata?.details?.length > 0">Patient General Test details</h3>
                                <div class="table-responsive  example-container mat-elevation-z8"
                                    *ngIf="patientdetailsdata?.details?.length > 0">
                                    <table class="table">
                                        <thead>
                                            <th>Date</th>
                                            <th>Height(cms)</th>
                                            <th>Weight(Kgs)</th>
                                            <th>BMi</th>
                                            <th>Blood Presure</th>
                                            <th>Acuity Of Vision</th>
                                            <th>Blood Group</th>
                                            <th>Temperature(°F)</th>
                                            <th>comment</th>
                                        </thead>
                                        <tbody>
                                            <tr class="previousData" *ngFor="let item of patientdetailsdata?.details">
                                                <td>{{item.createdAt | date:"dd-MM-yyyy HH:mm"}}</td>
                                                <td>{{item.height}}</td>
                                                <td>{{item.weight}}</td>
                                                <td>{{item.BMI}}</td>
                                                <td>{{item.BP}}</td>
                                                <td>{{item.acuityOfVision}}</td>
                                                <td>{{item.bloodGroup}}</td>
                                                <td>{{item.temperature}}</td>
                                                <td>{{item.comment}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>

                    <div class="mt-3">
                        <mat-accordion class="example-headers-align mt-2" multi>
                            <mat-expansion-panel>
                                <mat-expansion-panel-header (click)="accordian('test')">
                                    <mat-panel-title>
                                        Test
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <!-- <div class="addRow text-right">
                                    <mat-icon (click)="addTestsItem()" style="cursor: pointer;">add</mat-icon>
                                </div> -->
                                <div class=" mt-2 mr-2">
                                    <mat-form-field class="example-full-width searchTest">
                                        <input type="text" placeholder="Search Tests" aria-label="Number" matInput
                                            [(ngModel)]="testControl" [ngModelOptions]="{standalone: true}"
                                            (keyup)="getTests($event)" [matAutocomplete]="auto1">
                                        <!-- (keyup)="checkPin($event)"  -->
                                        <mat-autocomplete autoActiveFirstOption #auto1="matAutocomplete"
                                            (optionSelected)="onChangeTestValue($event.option.value)">
                                            <mat-option *ngFor="let option of tests" [value]="option">
                                                {{option?.name}} <b>|</b> {{option?.type}}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </div>

                                <mat-card *ngIf="sampleTestArray?.length >0">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>S.No</th>
                                                <th>Test Names</th>
                                                <th>Action</th>
                                            </tr>
                                            <tr *ngFor="let item of sampleTestArray ; let i=index">
                                                <td>{{i+1}}</td>
                                                <td>{{item.name}}</td>
                                                <td>
                                                    <mat-icon class="deleteTests"
                                                        (click)="deleteTestsFromSelectionList(item)"
                                                        style="cursor: pointer; background-color: none;">delete
                                                    </mat-icon>
                                                </td>
                                            </tr>
                                        </thead>
                                    </table>
                                </mat-card>



                                <!-- <div formArrayName="tests" class="d-none"
                                    *ngFor="let item of patientRegistrationForm.get('tests')['controls'];  let i = index;">
                                    {{item}}
                                    <div [formGroupName]="i">
                                        <div class="row" style="align-items: center;">
                                            <div class="col-md-11">
                                                <div class="row">
                                                    <div class="col-lg-4">
                                                        <div class="form-group">
                                                            <label>Label</label>
                                                            <select class="form-control"
                                                                (change)="onSelectTest($event,i)"
                                                                formControlName="test">
                                                                <option value="" disabled>Select Test Name</option>
                                                                <option value="{{item._id}}" *ngFor="let item of tests">
                                                                    {{item.name}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-4">
                                                        <div class="form-group">
                                                            <label>Value</label>
                                                            <input type="text" class="form-control"
                                                                formControlName="value" placeholder="Value">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-4">
                                                        <div class="form-group">
                                                            <label>Comment</label>
                                                            <textarea type="text" class="form-control"
                                                                formControlName="comment"
                                                                placeholder="Comment"></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-1">
                                                <div  class="text-center removeIcon">
                                                    <span (click)="removePatientTest(i)">&times;</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> -->
                                <h3 *ngIf="patientdetailsdata?.tests?.length > 0">Previous Tests</h3>
                                <div class="table-responsive  example-container mat-elevation-z8"
                                    *ngIf="patientdetailsdata?.tests?.length > 0">
                                    <table class="table">
                                        <thead>
                                            <th>Date</th>
                                            <th>Test Name</th>
                                            <th>Value</th>
                                            <th>comment</th>
                                            <th>Status</th>
                                            <!-- <th>Actions</th> -->
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let item of patientdetailsdata?.tests">
                                                <td>{{ item.createdAt | date:"dd-MM-yyyy HH:mm" }}</td>
                                                <td>{{ item.test?.name }}</td>
                                                <!-- <td>
                                                    <div *ngIf="item?.testResult?.resultType!='template'">
                                                        {{ item.value }}
                                                    </div>
                                                    <div *ngIf="item?.testResult?.resultType=='template'">
                                                        <button class="btn btn-md px-2"
                                                            (click)="open(content,item)">View Report</button>
                                                    </div>
                                                </td> -->
                                                <td>
                                                    <!-- {{ item.value }} -->
                                                    <div
                                                        *ngIf="item?.testResult?.resultType!='template' && item.status == 'completed'">
                                                        {{ item.value }}
                                                    </div>
                                                    <!-- <div *ngIf="item?.testResult?.resultType!='template' && item.status == 'completed'">
                                                        <button class="btn btn-md px-2"
                                                            (click)="open(content,item)">View Report</button>
                                                    </div> -->
                                                    <div
                                                        *ngIf="item?.testResult?.resultType=='template' && item.status == 'completed'">
                                                        <button class="btn btn-md px-2"
                                                            (click)="open(content,item)">View Report</button>
                                                    </div>
                                                </td>
                                                <td>{{ item.comment }}</td>
                                                <td>{{ item.status }}</td>
                                                <!-- <td>
                                                    <div>
                                                        <span>
                                                            <mat-icon class="deleteTests" style="cursor: pointer;" (click)="editTests(item,myDailog)">edit
                                                            </mat-icon>
                                                        </span>&nbsp;
                                                    </div>
                                                </td> -->
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                    <div class="mt-3">
                        <mat-accordion class="example-headers-align mt-2" multi>
                            <mat-expansion-panel>
                                <mat-expansion-panel-header (click)="accordian('past')">
                                    <mat-panel-title>
                                        Past Medic History
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div class="addRow text-right">
                                    <button (click)="addmedicalHistoryItem()">Add row</button>
                                    <!-- <mat-icon (click)="addmedicalHistoryItem()">add</mat-icon> -->
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Medicine Name</th>
                                                <th>Frequency</th>
                                                <th>Number of Days</th>
                                                <th>Comment</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr formArrayName="medicalHistory"
                                                *ngFor="let item of patientRegistrationForm.get('medicalHistory')['controls'];  let i = index;">
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="medicine"></td>
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="frequency"></td>
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="noOfDays"></td>
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="comment"></td>
                                                <td [formGroupName]="i">
                                                    <mat-icon (click)="removePatientmedicalHistory(i)">delete</mat-icon>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- <div formArrayName="medicalHistory"
                                    *ngFor="let item of patientRegistrationForm.get('medicalHistory')['controls'];  let i = index;">
                                    <div [formGroupName]="i">
                                        <div class="row">
                                            <div class="col-lg-3">
                                                <div class="form-group">
                                                    <label>Medicine Name</label>
                                                    <input type="text" class="form-control" formControlName="medicine">
                                                </div>
                                            </div>
                                            <div class="col-lg-3">
                                                <div class="form-group">
                                                    <label>frequency</label>
                                                    <input type="text" class="form-control" formControlName="frequency">
                                                </div>
                                            </div>
                                            <div class="col-lg-2">
                                                <div class="form-group">
                                                    <label for="">number of days</label>
                                                    <input type="text" class="form-control" formControlName="noOfDays">
                                                </div>
                                            </div>
                                            <div class="col-lg-3">
                                                <div class="form-group">
                                                    <label>Comment</label>
                                                    <textarea type="text" class="form-control"
                                                        formControlName="comment"></textarea>

                                                </div>
                                            </div>
                                            <div class="col-lg-1 mt-5" *ngIf="i>0">
                                                <div  class="text-center removeIcon">
                                                    <span (click)="removePatientmedicalHistory(i)">&times;</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> -->
                                <h3 *ngIf="patientdetailsdata?.medicalHistory?.length > 0">Medical History details</h3>
                                <div class="table-responsive  example-container mat-elevation-z8"
                                    *ngIf="patientdetailsdata?.medicalHistory?.length > 0">
                                    <table class="table">
                                        <thead>
                                            <th>Date</th>
                                            <th>Medicine</th>
                                            <th>Frequency</th>
                                            <th>noOfDays</th>
                                            <th>comment</th>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let item of patientdetailsdata?.medicalHistory">
                                                <td>{{ item.createdAt | date:"dd-MM-yyyy HH:mm" }}</td>
                                                <td>{{ item.medicine }}</td>
                                                <td>{{ item.frequency }}</td>
                                                <td>{{ item.noOfDays }}</td>
                                                <td>{{ item.comment }}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                    <div class="mt-3">
                        <mat-accordion class="example-headers-align mt-2" multi>
                            <mat-expansion-panel>
                                <mat-expansion-panel-header (click)="accordian('family')">
                                    <mat-panel-title>
                                        Family History
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div class="addRow text-right">
                                    <button (click)="addfamilyHistoryItem()">Add row</button>
                                    <!-- <mat-icon (click)="addmedicalHistoryItem()">add</mat-icon> -->
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Decease</th>
                                                <th>Relation With Patient</th>
                                                <th>From Years</th>
                                                <th>Comment</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr formArrayName="familyHistory"
                                                *ngFor="let item of patientRegistrationForm.get('familyHistory')['controls'];  let i = index;">
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="decease"></td>
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="relation"></td>
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="fromYears"></td>
                                                <td [formGroupName]="i"><input type="text" class="form-control"
                                                        formControlName="comment"></td>
                                                <td [formGroupName]="i">
                                                    <mat-icon (click)="removePatientfamilyHistory(i)">delete</mat-icon>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- <div class="addRow text-right">
                                    <mat-icon (click)="addfamilyHistoryItem()">add</mat-icon>
                                </div>
                                <div formArrayName="familyHistory"
                                    *ngFor="let item of patientRegistrationForm.get('familyHistory')['controls'];  let i = index;">
                                    <div [formGroupName]="i">
                                        <div class="row">
                                            <div class="col-lg-3">
                                                <div class="form-group">
                                                    <label>Decease</label>
                                                    <input type="text" class="form-control" formControlName="decease">
                                                </div>
                                            </div>
                                            <div class="col-lg-3">
                                                <div class="form-group">
                                                    <label>Relation With Patient</label>
                                                    <input type="text" class="form-control" formControlName="relation">
                                                </div>
                                            </div>
                                            <div class="col-lg-2">
                                                <div class="form-group">
                                                    <label for="">From Years</label>
                                                    <input type="text" class="form-control" formControlName="fromYears">
                                                </div>
                                            </div>
                                            <div class="col-lg-3">
                                                <div class="form-group">
                                                    <label>Comment</label>
                                                    <textarea type="text" class="form-control"
                                                        formControlName="comment"></textarea>
                                                </div>
                                            </div>
                                            <div class="col-lg-1 mt-5" *ngIf="i>0">
                                                <div  class="text-center removeIcon">
                                                    <span (click)="removePatientfamilyHistory(i)">&times;</span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div> -->
                                <h3 *ngIf="patientdetailsdata?.familyHistory?.length > 0">Family History details</h3>
                                <div class="table-responsive  example-container mat-elevation-z8"
                                    *ngIf="patientdetailsdata?.familyHistory?.length > 0">
                                    <table class="table">
                                        <thead>
                                            <th>Date</th>
                                            <th>Decease</th>
                                            <th>Relation</th>
                                            <th>FromYears</th>
                                            <th>comment</th>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let item of patientdetailsdata?.familyHistory">
                                                <td>{{ item.createdAt | date:"dd-MM-yyyy HH:mm" }}</td>
                                                <td>{{ item.decease }}</td>
                                                <td>{{ item.relation }}</td>
                                                <td>{{ item.fromYears }}</td>
                                                <td>{{ item.comment }}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                    <div class="mt-3">
                        <mat-accordion class="example-headers-align mt-2" multi>
                            <mat-expansion-panel>
                                <mat-expansion-panel-header (click)="accordian('doctorReview')">
                                    <mat-panel-title>
                                        Doctor Review
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div class="addRow text-right">
                                    <button (click)="addDoctorReviewItem()">Add row</button>
                                    <!-- <mat-icon (click)="addmedicalHistoryItem()">add</mat-icon> -->
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Review</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr formArrayName="doctorReview"
                                                *ngFor="let item of patientRegistrationForm.get('doctorReview')['controls'];  let i = index;">
                                                <td [formGroupName]="i"><textarea type="text" class="form-control"
                                                        formControlName="review" placeholder="Review"></textarea></td>
                                                <td [formGroupName]="i">
                                                    <mat-icon (click)="removePatientdoctorReview(i)">delete</mat-icon>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- <div class="addRow text-right">
                                    <mat-icon (click)="addDoctorReviewItem()">add</mat-icon>
                                </div>
                                <div formArrayName="doctorReview"
                                    *ngFor="let item of patientRegistrationForm.get('doctorReview')['controls'];  let i = index;">
                                    <div [formGroupName]="i">
                                        <div class="row">
                                            <div class="col-lg-11">
                                                <div class="form-group">
                                                    <label>Review</label>
                                                    <textarea type="text" class="form-control" formControlName="review"
                                                        placeholder="Review"></textarea>
                                                </div>
                                                
                                            </div>
                                            <div class="col-lg-1 mt-5" *ngIf="i>0">
                                                <div  class="text-center removeIcon">
                                                    <span (click)="removePatientdoctorReview(i)">&times;</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> -->
                                <h3 *ngIf="patientdetailsdata?.doctorReviews?.length > 0">Previous Reviews</h3>
                                <div class="table-responsive  example-container mat-elevation-z8"
                                    *ngIf="patientdetailsdata?.doctorReviews?.length > 0">
                                    <table class="table">
                                        <thead>
                                            <th>Date</th>
                                            <th>Review</th>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let item of patientdetailsdata?.doctorReviews">
                                                <td>{{ item.createdAt | date:"dd-MM-yyyy HH:mm" }}</td>
                                                <td>{{ item.review }}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                    <div class="mt-3" *ngIf="showQuestionnaireView">
                        <mat-accordion class="example-headers-align mt-2" multi>
                            <mat-expansion-panel>
                                <mat-expansion-panel-header (click)="accordian('questionnaireView')">
                                    <mat-panel-title>
                                        Questionnaire Review
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <mat-card class="mt-3 questionnaire">
                                            <h4>Questionnaire</h4>
                                            <table class="table table-bordered m-0 text-center">
                                                <tr>
                                                    <th class="sno">S.No</th>
                                                    <th class="question">Question</th>
                                                    <th class="answer">Answer</th>
                                                    <th>Code</th>
                                                </tr>
                                            </table>
                                            <div *ngFor="let grp of questionForm.controls">
                                                <form [formGroup]="grp" class="questForm">
                                                    <table class="table table-bordered m-0 text-center">
                                                        <td class="sec" >{{grp.value.name}}</td>
                                                    </table>
                                                    <!-- <label > </label> -->
                                                    <div formArrayName="questions"
                                                        *ngFor="let item of grp?.get('questions')['controls'];  let i = index;">
                                                        <table [formGroup]="item" class="table table-bordered m-0">
                                                            <tr>
                                                                <td class="sno">{{i+1}}</td>
                                                                <td class="question">{{item?.value?.question}}</td>
                                                                <td class="answer">
                                                                    <div *ngIf="item.value.type == 'options'">
                                                                        <mat-radio-group aria-label="Select an option"
                                                                            class="checkbox" formControlName="answer">
                                                                            <mat-radio-button [disabled]="true"
                                                                                class="col-lg-12 optionText"
                                                                                *ngFor="let answers of item.value?.possibleAnswers"
                                                                                [value]="answers">{{answers}}
                                                                            </mat-radio-button>
                                                                            <!-- <mat-radio-button value="no">No</mat-radio-button> -->
                                                                        </mat-radio-group>
                                                                    </div>
                                                                    <div *ngIf="item.value.type == 'checkbox'">

                                                                        <!-- <label formArrayName="answer" *ngFor="let order of item.get('answer')['controls']; let i = index">
                                                                        <input type="checkbox" [formControlName]="i">
                                                                        {{item.value.possibleAnswers[i]}}
                                                                      </label> -->
                                                                        <section class="example-section checkbox"
                                                                            formArrayName="answer"
                                                                            *ngFor="let order of item.get('answer')['controls']; let i = index">
                                                                            <mat-checkbox class="example-margin " [disabled]="true"
                                                                                [formControlName]="i"
                                                                                class="col-lg-12 optionText"
                                                                                [value]="item.value.possibleAnswers[i]">
                                                                                {{item.value.possibleAnswers[i]}}
                                                                            </mat-checkbox>
                                                                        </section>
                                                                    </div>
                                                                    <div class="input-with-measure"
                                                                        *ngIf="item.value.type == 'input'|| item.value.type == 'paragraph' || item.value.type == 'textArea' || item.value.type == 'numeric'">
                                                                        <input class="form-control"
                                                                            formControlName="answer" readonly><span>{{item.value.units}}</span>
                                                                    </div>
                                                                    <div *ngIf="item.value.type == 'date'">
                                                                        <input class="form-control" type="date"
                                                                            formControlName="answer" readonly> 
                                                                    </div>
                                                                    <div *ngIf="item.value.type == 'radio'">
                                                                        <mat-radio-group aria-label="Select an option"
                                                                            formControlName="answer">
                                                                            <mat-radio-button value="yes" [disabled]="true">Yes
                                                                            </mat-radio-button>
                                                                            <mat-radio-button value="no" [disabled]="true">No
                                                                            </mat-radio-button>
                                                                        </mat-radio-group>
                                                                    </div>
                                                                </td>
                                                                <td>{{item.value.code}}</td>
                                                            </tr>

                                                            <tr formArrayName="subquestions"
                                                                *ngFor="let sub of item.get('subquestions')['controls'];  let j = index;">
                                                                <!-- < > -->
                                                                <td [formGroupName]="j" class="sno">{{i+1}}.{{j+1}}</td>
                                                                <td [formGroupName]="j" class="question">
                                                                    {{sub.value.question}}</td>
                                                                <td [formGroupName]="j" class="answer">
                                                                    <div *ngIf="sub.value.type == 'options'">
                                                                        <mat-radio-group aria-label="Select an option"
                                                                            class="checkbox" formControlName="answer">
                                                                            <mat-radio-button [disabled]="true"
                                                                                class="col-lg-12 optionText"
                                                                                *ngFor="let answers of sub.value?.possibleAnswers"
                                                                                [value]="answers">{{answers}}
                                                                            </mat-radio-button>
                                                                            <!-- <mat-radio-button value="no">No</mat-radio-button> -->
                                                                        </mat-radio-group>
                                                                    </div>
                                                                    <div *ngIf="sub.value.type == 'checkbox'">

                                                                        <!-- <label formArrayName="answer" *ngFor="let order of item.get('answer')['controls']; let i = index">
                                                                               <input type="checkbox" [formControlName]="i">
                                                                               {{item.value.possibleAnswers[i]}}
                                                                             </label> -->
                                                                        <section class="example-section checkbox"
                                                                            formArrayName="answer"
                                                                            *ngFor="let order of sub.get('answer')['controls']; let i = index">
                                                                            <mat-checkbox class="example-margin" [disabled]="true"
                                                                                [formControlName]="i"
                                                                                class="col-lg-12 optionText"
                                                                                [value]="sub.value.possibleAnswers[i]" >
                                                                                {{sub.value.possibleAnswers[i]}}
                                                                                
                                                                            </mat-checkbox>
                                                                        </section>
                                                                    </div>
                                                                    <div
                                                                        *ngIf="sub.value.type == 'input'|| sub.value.type == 'paragraph' || sub.value.type == 'textArea' || sub.value.type == 'numeric'">
                                                                        <input class="form-control"
                                                                            formControlName="answer" readonly>{{sub.value?.units}}
                                                                    </div>
                                                                    <div *ngIf="sub.value.type == 'date'">
                                                                        <input class="form-control" type="date"
                                                                            formControlName="answer" readonly>
                                                                    </div>
                                                                    <div *ngIf="sub.value.type == 'radio'">
                                                                        <mat-radio-group aria-label="Select an option"
                                                                            formControlName="answer">
                                                                            <mat-radio-button value="yes" [disabled]="true">Yes
                                                                            </mat-radio-button>
                                                                            <mat-radio-button value="no" [disabled]="true">No
                                                                            </mat-radio-button>
                                                                        </mat-radio-group>
                                                                    </div>
                                                                </td>
                                                                <td [formGroupName]="j">{{sub.value.code}}</td>

                                                            </tr>
                                                        </table>
                                                    </div>
                                                </form>
                                            </div>
                                        </mat-card>
                                    </div>
                                </div>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="showQuestioner && !showUploadFiles">
            <div class="card bg-light">
                <div class="card-body">
                    <div class="card p-3">
                        <div class="row">
                            <div class="col-md-4 ">
                                <div class="form-group">
                                    <label for="">PID</label>
                                    <input class="form-control" formControlName="PID" [disabled]>
                                </div>
                                <div class="form-group">
                                    <label for="">Patient Name</label>
                                    <input class="form-control" formControlName="name">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group" *ngIf="patientdetailsdata?.createdAt">
                                    <label for="">REG. Date</label>
                                    <input class="form-control" disabled
                                        [value]="patientdetailsdata?.createdAt | date:'dd-MM-yyyy HH:mm'">
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="qr-code border-success">
                                    <label>Bar Code</label>
                                    <ngx-barcode [bc-value]="value" [bc-display-value]="true"></ngx-barcode>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="qr-code border-success">
                                    <label>QR Code</label>
                                    <qrcode [qrdata]="value" [width]="150" [errorCorrectionLevel]="'M'"></qrcode>
                                </div>
                            </div>
                        </div>
                    </div>
                    <mat-card class="mt-3 questionnaire">
                        <h4>Questionnaire</h4>
                        <table class="table table-bordered m-0 text-center">
                            <tr>
                                <th class="sno">S.No</th>
                                <th class="question">Question</th>
                                <th class="answer">Answer</th>
                                <th>Code</th>
                            </tr>
                        </table>
                        <div *ngFor="let grp of questionForm.controls">
                            <form [formGroup]="grp" class="questForm">
                                <table class="table table-bordered m-0 text-center">
                                    <td class="sec">{{grp.value.name}}</td>
                                </table>
                                <!-- <label > </label> -->
                                <div formArrayName="questions"
                                    *ngFor="let item of grp?.get('questions')['controls'];  let i = index;">
                                    <table [formGroup]="item" class="table table-bordered m-0">
                                        <tr>
                                            <td class="sno">{{i+1}}</td>
                                            <td class="question">{{item?.value?.question}}</td>
                                            <td class="answer">
                                                <div *ngIf="item.value.type == 'options'">
                                                    <mat-radio-group aria-label="Select an option" class="checkbox"
                                                        formControlName="answer">
                                                        <mat-radio-button class="col-lg-12 optionText"
                                                            *ngFor="let answers of item.value?.possibleAnswers"
                                                            [value]="answers">{{answers}}</mat-radio-button>
                                                        <!-- <mat-radio-button value="no">No</mat-radio-button> -->
                                                    </mat-radio-group>
                                                </div>
                                                <div *ngIf="item.value.type == 'checkbox'">

                                                    <!-- <label formArrayName="answer" *ngFor="let order of item.get('answer')['controls']; let i = index">
                                                    <input type="checkbox" [formControlName]="i">
                                                    {{item.value.possibleAnswers[i]}}
                                                  </label> -->
                                                    <section class="example-section checkbox" formArrayName="answer"
                                                        *ngFor="let order of item.get('answer')['controls']; let i = index">
                                                        <mat-checkbox class="example-margin " [formControlName]="i"
                                                            class="col-lg-12 optionText"
                                                            [value]="item.value.possibleAnswers[i]">
                                                            {{item?.value?.possibleAnswers[i]}}</mat-checkbox>
                                                    </section>
                                                </div>
                                                <div class="input-with-measure"
                                                    *ngIf="item.value.type == 'input'|| item.value.type == 'paragraph' || item.value.type == 'textArea' || item.value.type == 'numeric'">
                                                    <input class="form-control"
                                                        formControlName="answer"><span>{{item?.value?.units}}</span>
                                                </div>
                                                <div class="input-with-measure"
                                                    *ngIf="item.value.type == 'dropdown'">
                                                   
                                                   
                                                    <ng-select [placeholder]="getPlaceholder(item?.value?.question)"  formControlName="answer" >
                                                        <!-- <ng-option *ngFor="let language of item?.value?.possibleAnswers" [value]="language">{{language | titlecase }}</ng-option> -->
                                                        <ng-option *ngFor="let language of item?.value?.possibleAnswers" [value]="language">{{language | titlecase }}</ng-option>
                                                    </ng-select>
                                                    <!-- <select class="form-control" formControlName="answer">
                                                        <option value="" disabled>Select Language</option>
                                                        <option *ngFor="let language of item?.value?.possibleAnswers" value="{{language}}">{{language | titlecase }}</option>
                                                    </select> -->
                                                    <!-- <input class="form-control"
                                                        formControlName="answer"><span>{{item?.value?.units}}</span> -->
                                                </div>
                                                <div class="input-with-measure"
                                                    *ngIf="item.value.type == 'time'">
                                                    <!-- <igx-time-picker  formControlName="answer">
                                                    </igx-time-picker> -->
                                                    <input class="form-control"
                                                        formControlName="answer"><span>{{item?.value?.units}}</span>
                                                </div>
                                                <div *ngIf="item.value.type == 'date'">
                                                    <input class="form-control" type="date" formControlName="answer">
                                                </div>
                                                <div *ngIf="item.value.type == 'radio'">
                                                    <mat-radio-group aria-label="Select an option"
                                                        formControlName="answer">
                                                        <mat-radio-button value="yes">Yes</mat-radio-button>
                                                        <mat-radio-button value="no">No</mat-radio-button>
                                                    </mat-radio-group>
                                                </div>
                                            </td>
                                            <td>{{item.value.code}}</td>
                                        </tr>

                                        <tr formArrayName="subquestions"
                                            *ngFor="let sub of item.get('subquestions')['controls'];  let j = index;">
                                            <!-- < > -->
                                            <td [formGroupName]="j" class="sno">{{i+1}}.{{j+1}}</td>
                                            <td [formGroupName]="j" class="question">{{sub.value.question}}</td>
                                            <td [formGroupName]="j" class="answer">
                                                <div *ngIf="sub.value.type == 'options'">
                                                    <mat-radio-group aria-label="Select an option" class="checkbox"
                                                        formControlName="answer">
                                                        <mat-radio-button class="col-lg-12 optionText"
                                                            *ngFor="let answers of sub.value?.possibleAnswers"
                                                            [value]="answers">{{answers}}</mat-radio-button>
                                                        <!-- <mat-radio-button value="no">No</mat-radio-button> -->
                                                    </mat-radio-group>
                                                </div>
                                                <div *ngIf="sub.value.type == 'checkbox'">

                                                    <!-- <label formArrayName="answer" *ngFor="let order of item.get('answer')['controls']; let i = index">
                                                           <input type="checkbox" [formControlName]="i">
                                                           {{item.value.possibleAnswers[i]}}
                                                         </label> -->
                                                    <section class="example-section checkbox" formArrayName="answer"
                                                        *ngFor="let order of sub.get('answer')['controls']; let i = index">
                                                        <mat-checkbox class="example-margin" [formControlName]="i"
                                                            class="col-lg-12 optionText"
                                                            [value]="sub.value.possibleAnswers[i]">
                                                            {{sub.value.possibleAnswers[i]}}</mat-checkbox>
                                                    </section>
                                                </div>
                                                <div
                                                    *ngIf="sub.value.type == 'input'|| sub.value.type == 'paragraph' || sub.value.type == 'textArea' || sub.value.type == 'numeric'">
                                                    <input class="form-control"
                                                        formControlName="answer">{{sub.value?.units}}
                                                </div>
                                                <div class="input-with-measure"
                                                *ngIf="sub.value.type == 'dropdown'">
                                               
                                               
                                                <ng-select [placeholder]="getPlaceholder(sub?.value?.question)"  formControlName="answer" >
                                                    <!-- <ng-option *ngFor="let language of item?.value?.possibleAnswers" [value]="language">{{language | titlecase }}</ng-option> -->
                                                    <ng-option *ngFor="let language of sub?.value?.possibleAnswers" [value]="language">{{language | titlecase }}</ng-option>
                                                </ng-select>
                                                <!-- <select class="form-control" formControlName="answer">
                                                    <option value="" disabled>Select Language</option>
                                                    <option *ngFor="let language of item?.value?.possibleAnswers" value="{{language}}">{{language | titlecase }}</option>
                                                </select> -->
                                                <!-- <input class="form-control"
                                                    formControlName="answer"><span>{{item?.value?.units}}</span> -->
                                            </div>
                                            <div class="input-with-measure"
                                                *ngIf="sub.value.type == 'time'">
                                                <!-- <igx-time-picker  formControlName="answer">
                                                </igx-time-picker> -->
                                                <input class="form-control"
                                                    formControlName="answer"><span>{{sub?.value?.units}}</span>
                                            </div>
                                                <div *ngIf="sub.value.type == 'date'">
                                                    <input class="form-control" type="date" formControlName="answer">
                                                </div>
                                                <div *ngIf="sub.value.type == 'radio'">
                                                    <mat-radio-group aria-label="Select an option"
                                                        formControlName="answer">
                                                        <mat-radio-button value="yes">Yes</mat-radio-button>
                                                        <mat-radio-button value="no">No</mat-radio-button>
                                                    </mat-radio-group>
                                                </div>
                                            </td>
                                            <td [formGroupName]="j">{{sub.value.code}}</td>

                                        </tr>
                                    </table>
                                </div>
                            </form>
                        </div>
                        <button class="btn" (click)="questionnaireForm()">Apply</button>
                    </mat-card>
                </div>
            </div>
        </div>
        <div *ngIf="!showQuestioner && showUploadFiles">
            <div class="card bg-light">
                <div class="card-body">
                    <div class="card p-3">
                        <div class="row">
                            <div class="col-md-4 ">
                                <div class="form-group">
                                    <label for="">PID</label>
                                    <input class="form-control" formControlName="PID" readonly>
                                </div>
                                <div class="form-group">
                                    <label for="">Patient Name</label>
                                    <input class="form-control" formControlName="name" readonly>    
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group" *ngIf="patientdetailsdata?.createdAt">
                                    <label for="">REG. Date</label>
                                    <input class="form-control" readonly
                                        [value]="patientdetailsdata?.createdAt | date:'dd-MM-yyyy HH:mm'">
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="qr-code border-success">
                                    <label>Bar Code</label>
                                    <ngx-barcode [bc-value]="value" [bc-display-value]="true"></ngx-barcode>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="qr-code border-success">
                                    <label>QR Code</label>
                                    <qrcode [qrdata]="value" [width]="150" [errorCorrectionLevel]="'M'"></qrcode>
                                </div>
                            </div>
                        </div>
                    </div>
                    <mat-card class="mt-3">
                        <h4>Upload Reports</h4>
                        <div>
                            <!-- [formGroup]="myForm" (submit)="questionnaireForm()" -->
                            <form>
                                <div class="form-group">
                                    <input type="file" multiple class="form-control" [(ngModel)]="file" name="file"
                                        (change)="UploadFiles($event)">
                                </div>
                                <button class="btn" (click)="submitUploadFiles()" [attr.disabled]="uploadFilesData.length < 1 ? false : null " [ngClass]="{'disable-button': uploadFilesData.length  == 0}">Submit</button>
                            </form>
                        </div>
                        <h4 *ngIf="uploadFilesDetails?.length >0">Previous Upload Reports</h4>
                        <div class="row m-2">
                            <div class="col-lg-3" *ngFor="let item of uploadFilesDetails">
                                <div class="imagewidth">
                                    <img src="{{image}}/{{item?.attachment}}" width="100%">

                                </div>
                            </div>
                            <!-- <div class="col-lg-4">
                            <div class="imgae">
                                <img src="../../../assets/depart.jpg" class="img-responsive img-fluid">
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="imgae">
                                <img src="../../../assets/depart.jpg" class="img-responsive img-fluid">
                            </div>
                        </div> -->
                        </div>
                    </mat-card>
                </div>
            </div>
        </div>
        <div class=" text-right my-3 submitButton" *ngIf="!showQuestioner && !showUploadFiles">
            <button class="btn mr-3" (click)="clearForm()">Clear</button>
            <button class="btn " type="submit" (click)="onSubmit()" >Save</button>
            <!-- [disabled]="!patientRegistrationForm.valid" [ngClass]="{'btnDisabled':!patientRegistrationForm.valid}" -->
        </div>
    </form>
</div>


<!-- [ngClass]="{'printident': showqrcode}" -->
<!-- id="printform" directPrint="true" ngxPrintItemMarker-->
<div class="printident">
    <div class="card bg-light">
        <div class="card-body">
            <div class="card p-3">

                <form>
                    <div class="row">

                        <div class="col-md-4 ">
                            <div class="form-group">
                                <label for="">PID</label>
                                <input class="form-control" [value]="barCodeValue">
                            </div>
                            <div class="form-group">
                                <label for="">Patient Name</label>
                                <input class="form-control" [value]="patientdetailsdata?.name"
                                    *ngIf="patientdetailsdata?.name">
                                <input class="form-control" *ngIf="!patientdetailsdata?.name">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group" *ngIf="patientdetailsdata?.createdAt || createdAt">
                                <label for="">REG. Date</label>
                                <!-- <input class="form-control" disabled *ngIf="patientdetailsdata?.createdAt" [value]="patientdetailsdata?.createdAt | date:'dd-MM-yyyy'"> -->
                                <input class="form-control" style="font-size: 13px;" *ngIf="createdAt"
                                    [value]="createdAt | date:'dd-MM-yyyy HH:mm'">
                            </div>
                            <div class="form-group">
                                <label>Gender</label>
                                <input class="form-control" [value]="patientdetailsdata?.gender"
                                    *ngIf="patientdetailsdata?.gender">
                                <input class="form-control" *ngIf="!patientdetailsdata?.gender">
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="qr-code border-success">
                                <label>Bar Code</label>
                                <ngx-barcode [bc-value]="barCodeValue" [bc-display-value]="true" *ngIf="barCodeValue">
                                </ngx-barcode>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="qr-code border-success">
                                        <label>QR Code</label>
                                        <!-- <qrcode 
                                        [qrdata]="barCodeValue" [width]="150"  [errorCorrectionLevel]="'M'" [elementType]="'svg'" *ngIf="barCodeValue"
                                        ></qrcode> -->
                                        <ngx-qrcode [elementType]="'svg'" [value]="barCodeValue" cssClass="aclass"
                                            [width]="120" errorCorrectionLevel="L">
                                        </ngx-qrcode>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <img src="../../../assets/PreviaLogo.png" class="img-responsive img-fluid">
                                    <!-- <img [src]="sanitizer.bypassSecurityTrustUrl('/' + cardModel[r.content].value)" /> -->
                                </div>
                            </div>

                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label>DOB</label>
                                <input class="form-control" [value]="patientdetailsdata?.DOB"
                                    *ngIf="patientdetailsdata?.DOB">
                                <input class="form-control" *ngIf="!patientdetailsdata?.DOB">
                            </div>
                        </div>
                        <div class="col-md-1">
                            <div class="form-group">
                                <label>Age</label>
                                <input class="form-control" [value]="age">
                                <!-- <input class="form-control" *ngIf="!patientdetailsdata?.name"> -->
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Mobile</label>
                                <input class="form-control" [value]="patientdetailsdata?.mobileNumber"
                                    *ngIf="patientdetailsdata?.mobileNumber">
                                <input class="form-control" *ngIf="!patientdetailsdata?.mobileNumber">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Email</label>
                                <input class="form-control" [value]="patientdetailsdata?.emailAddress"
                                    *ngIf="patientdetailsdata?.emailAddress">
                                <input class="form-control" *ngIf="!patientdetailsdata?.emailAddress">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Proof Details</label>
                                <div class="input-flex">
                                    <input class="form-control borderRight" [value]="patientdetailsdata?.proofType"
                                    *ngIf="patientdetailsdata?.proofType">
                                     <input class="form-control borderRight" *ngIf="!patientdetailsdata?.proofType">
                                     <input class="form-control" [value]="patientdetailsdata?.proofValue"
                                    *ngIf="patientdetailsdata?.proofValue">
                                <input class="form-control" *ngIf="!patientdetailsdata?.proofValue">
                                </div>
                                <!-- <div *ngIf="submitted && f.aadhaar.errors" class="invalid-feedback">
                                    <div *ngIf="f.aadhaar.errors.required" >Please enter valid  Aadhar</div>
                                </div> -->
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Aaadhar</label>
                                <input class="form-control" [value]="patientdetailsdata?.aadhaar"
                                    *ngIf="patientdetailsdata?.aadhaar">
                                <input class="form-control" *ngIf="!patientdetailsdata?.aadhaar">
                            </div>
                        </div>

                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Economic Status</label>
                                <input class="form-control" [value]="patientdetailsdata?.economicStatus"
                                    *ngIf="patientdetailsdata?.economicStatus">
                                <input class="form-control" *ngIf="!patientdetailsdata?.economicStatus">
                            </div>
                        </div>

                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Occupation</label>
                                <input class="form-control" [value]="patientdetailsdata?.occupation"
                                    *ngIf="patientdetailsdata?.occupation">
                                <input class="form-control" *ngIf="!patientdetailsdata?.occupation">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Address</label>
                                <input class="form-control" [value]="patientdetailsdata?.address"
                                    *ngIf="patientdetailsdata?.address">
                                <input class="form-control" *ngIf="!patientdetailsdata?.address">
                            </div>
                        </div>

                        <div class="col-md-2">
                            <div class="form-group">
                                <label>City</label>
                                <input class="form-control" [value]="patientdetailsdata?.city"
                                    *ngIf="patientdetailsdata?.city">
                                <input class="form-control" *ngIf="!patientdetailsdata?.city">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>State</label>
                                <input class="form-control" [value]="patientdetailsdata?.state"
                                    *ngIf="patientdetailsdata?.state">
                                <input class="form-control" *ngIf="!patientdetailsdata?.state">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Habits</label>
                                <textarea type="text" class="form-control" [value]="patientdetailsdata?.habits"
                                    *ngIf="patientdetailsdata?.habits"></textarea>
                                <textarea type="text" class="form-control"
                                    *ngIf="!patientdetailsdata?.habits"></textarea>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>LifeStyle</label>
                                <textarea type="text" class="form-control" [value]="patientdetailsdata?.lifeStyle"
                                    *ngIf="patientdetailsdata?.lifeStyle"></textarea>
                                <textarea type="text" class="form-control"
                                    *ngIf="!patientdetailsdata?.lifeStyle"></textarea>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="card mt-3 bg-light">
        <div class="card-body">
            <div class="">
                <h3>Patient general tests</h3>
                <div class="table-responsive details "
                    *ngIf="!patientdetailsdata?.details?.length || patientdetailsdata?.details?.length == 0">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Height(cms)</th>
                                <th>Weight(Kgs)</th>
                                <th>BMi</th>
                                <th>Blood Presure</th>
                                <th>Acuity Of Vision</th>
                                <th>Blood Group</th>
                                <th>Temperature</th>
                                <th>comment</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="form-control b-0"></td>
                                <td><input type="text" class="form-control b-0"></td>
                                <td><input type="text" class="form-control b-0"></td>
                                <td><input type="text" class="form-control b-0"></td>
                                <td><input type="text" class="form-control b-0"></td>
                                <td><input type="text" class="form-control b-0"></td>
                                <td><input type="text" class="form-control b-0"></td>
                                <td><input type="text" class="form-control b-0"></td>
                            </tr>

                        </tbody>
                    </table>

                </div>
                <div class="table-responsive  example-container mat-elevation-z8"
                    *ngIf="patientdetailsdata?.details?.length > 0">
                    <table class="table table-bordered">
                        <thead>
                            <th>Date</th>
                            <th>Height(cms)</th>
                            <th>Weight(Kgs)</th>
                            <th>BMi</th>
                            <th>Blood Presure</th>
                            <th>Acuity Of Vision</th>
                            <th>Blood Group</th>
                            <th>Temperature(°F)</th>
                            <th>comment</th>
                        </thead>
                        <tbody>
                            <tr class="previousData" *ngFor="let item of patientdetailsdata?.details">
                                <td>{{item.createdAt | date:"dd-MM-yyyy HH:mm"}}</td>
                                <td>{{item.height}}</td>
                                <td>{{item.weight}}</td>
                                <td>{{item.BMI}}</td>
                                <td>{{item.BP}}</td>
                                <td>{{item.acuityOfVision}}</td>
                                <td>{{item.bloodGroup}}</td>
                                <td>{{item.temperature}}</td>
                                <td>{{item.comment}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
            <div class="mt-3">
                <h3>Tests</h3>
                <div *ngIf="!patientdetailsdata?.tests?.length || patientdetailsdata?.tests?.length == 0"
                    class="card cardLength" style="width: 100%;
                    height: 180px;
                    border-radius: 20px !important;"></div>
                <div class="table-responsive  example-container mat-elevation-z8"
                    *ngIf="patientdetailsdata?.tests?.length > 0">
                    <table class="table table-bordered">
                        <thead>
                            <th>Date</th>
                            <th>Test Name</th>
                            <th>Value</th>
                            <th>comment</th>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of patientdetailsdata?.tests">
                                <td>{{ item.createdAt | date:"dd-MM-yyyy HH:mm" }}</td>
                                <td>{{ item.test?.name }}</td>
                                <td>
                                    <div *ngIf="item?.testResult?.resultType!='template' && item.status == 'completed'">
                                        {{ item.value }}
                                    </div>
                                    <div *ngIf="item?.testResult?.resultType=='template'&& item.status == 'completed'">
                                        <button class="btn btn-md px-2">Template</button>
                                    </div>
                                </td>
                                <td>{{ item.comment }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-3">
                <h3>Past Medical History</h3>
                <div *ngIf="!patientdetailsdata?.medicalHistory?.length || patientdetailsdata?.medicalHistory?.length == 0"
                    class="card cardLength" style="width: 100%;
                    height: 180px;
                    border-radius: 20px !important;"></div>
                <div class="table-responsive  example-container mat-elevation-z8"
                    *ngIf="patientdetailsdata?.medicalHistory?.length > 0">
                    <table class="table table-bordered">
                        <thead>
                            <th>Date</th>
                            <th>Medicine</th>
                            <th>Frequency</th>
                            <th>noOfDays</th>
                            <th>comment</th>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of patientdetailsdata?.medicalHistory">
                                <td>{{ item.createdAt | date:"dd-MM-yyyy HH:mm" }}</td>
                                <td>{{ item.medicine }}</td>
                                <td>{{ item.frequency }}</td>
                                <td>{{ item.noOfDays }}</td>
                                <td>{{ item.comment }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-4">
                <h3>Family History</h3>
                <div *ngIf="!patientdetailsdata?.familyHistory?.length || patientdetailsdata?.familyHistory?.length == 0"
                    class="card cardLength" style="width: 100%;
                    height: 180px;
                    border-radius: 20px !important;"></div>
                <div class="table-responsive  example-container mat-elevation-z8"
                    *ngIf="patientdetailsdata?.familyHistory?.length > 0">
                    <table class="table table-bordered">
                        <thead>
                            <th>Date</th>
                            <th>Decease</th>
                            <th>Relation</th>
                            <th>FromYears</th>
                            <th>comment</th>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of patientdetailsdata?.familyHistory">
                                <td>{{ item.createdAt | date:"dd-MM-yyyy HH:mm" }}</td>
                                <td>{{ item.decease }}</td>
                                <td>{{ item.relation }}</td>
                                <td>{{ item.fromYears }}</td>
                                <td>{{ item.comment }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <br>

    <div class="card page-break">
        <div class="">

            <h3 class="text-center">Questionnaire - {{barCodeValue}}</h3>
            <div class=" m-2 p-3">
                <div>
                    <table class="table table-bordered">
                        <tr>
                            <th>S.No</th>
                            <th>Question</th>
                            <th>Response</th>
                            <th>Code</th>
                        </tr>
                        <ng-template #rowTemplateOutlet let-index="index" let-index2="index2" let-item="item"
                            let-Question="Question">
                            <tr class="tableheader qnHeading">
                                <!--  -->
                                <td colspan="5" style="background:#ddd;text-align:center;font-weight: bold;"
                                    *ngIf="index == 0">
                                    {{item.name}}
                                </td>
                            </tr>

                            <tr>
                                <td>{{index+1}}</td>
                                <td>{{Question.question}}</td>
                                <td>
                                    <span class="row"
                                        *ngIf="Question?.type === 'input' || Question?.type === 'textArea'|| Question?.type === 'dropdown'|| Question?.type === 'time'">
                                        <input type="text" style="border-width: 0px 0px 1px;
                                        border-style: dashed;
                                        border-color: black;
                                        margin-left: 6px;
                                        "><span style="font-size: 12px;">{{Question?.units}}</span>
                                    </span>

                                    <span *ngIf="Question?.type === 'paragraph'">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                    </span>
                                    <span *ngIf="Question?.type === 'radio'">
                                        1.Yes &nbsp;&nbsp;
                                        2.No
                                    </span>
                                    <span *ngIf="Question?.type === 'options'">
                                        <!-- 1.Yes &nbsp;&nbsp;
                                        2.No -->
                                        <p *ngFor="let answers of Question?.possibleAnswers ; let indexvalue=index">
                                            {{indexvalue+1}}.{{answers}} </p>
                                    </span>
                                    <span *ngIf="Question?.type === 'checkbox'">
                                        <div class="d-flex" style="align-items: center; margin-bottom: 10px;"
                                            *ngFor="let answers of Question?.possibleAnswers">
                                            <input type="checkbox">
                                            <span style="padding-left: 8px;">{{answers}}</span>
                                        </div>
                                    </span>
                                    <span *ngIf="Question?.type === 'numeric'">
                                        <div>
                                            <div style="display: flex;">
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <span>{{Question?.units}}</span>
                                            </div>
                                        </div>
                                    </span>

                                    <span *ngIf="Question?.type === 'date'"
                                        style="display: flex;justify-content: space-evenly;">
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">dd</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">mm</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">yyyy</div>
                                        </div>
                                    </span>
                                </td>
                                <td style="width: 15%;">{{Question.code}}</td>
                            </tr>
                            <tr *ngFor="let subQuestion of Question?.subQuestions; let ind=index;">
                                <td>{{index+1}}.{{ind+1}}</td>
                                <td>{{subQuestion?.question}}</td>

                                <td>
                                    <span class="row"
                                        *ngIf="subQuestion?.type === 'input' || subQuestion?.type === 'textArea' || subQuestion?.type === 'dropdown' || subQuestion?.type === 'time'">
                                        <input type="text" style="border-width: 0px 0px 1px;
                                        border-style: dashed;
                                        border-color: black;
                                        margin-left: 6px;
                                        "><span style="font-size: 12px;">{{subQuestion?.units}}</span>
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'radio'">
                                        1.Yes &nbsp;&nbsp;
                                        2.No
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'options'">
                                        <!-- 1.Yes &nbsp;&nbsp;
                                        2.No -->
                                        <p *ngFor="let answers of subQuestion?.possibleAnswers ; let indexvalue=index">
                                            {{indexvalue+1}}.{{answers}} </p>
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'checkbox'">
                                        <div class="d-flex" style="align-items: center;margin-bottom: 10px;"
                                            *ngFor="let answers of subQuestion?.possibleAnswers">
                                            <input type="checkbox">
                                            <span style="padding-left: 8px;">{{answers}}</span>
                                        </div>
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'numeric'">
                                        <div>
                                            <div style="display: flex;">
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <span>{{subQuestion?.units}}</span>
                                            </div>
                                        </div>
                                    </span>
                                    <span *ngIf="Question?.type === 'paragraph'">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'date'"
                                        style="display: flex;justify-content: space-evenly;">
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">dd</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">mm</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">yyyy</div>
                                        </div>
                                    </span>
                                </td>
                                <td style="width: 15%;">{{subQuestion?.code}}</td>
                            </tr>
                        </ng-template>

                        <ng-container *ngFor="let item of questionariesDetails;let inde=index;">
                            <ng-container *ngFor="let Question of item?.questions; let i=index;">
                                <ng-container
                                    *ngTemplateOutlet="rowTemplateOutlet; context:{item: item, Question: Question, index: i,index2:inde}">
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </table>
                </div>
            </div>


        </div>
    </div>
    <p style="page-break-after: always;">&nbsp;</p>
    <div class="card bg-light" *ngIf="showqrcode === true">
        <div class="card-body">
            <div class="card p-3">
                <form>
                    <div class="row">

                        <div class="col-md-4 ">
                            <div class="form-group">
                                <label for="">PID</label>
                                <input class="form-control" [value]="barCodeValue">
                            </div>
                            <div class="form-group">
                                <label for="">Patient Name</label>
                                <input class="form-control" [value]="patientdetailsdata?.name"
                                    *ngIf="patientdetailsdata?.name">
                                <input class="form-control" *ngIf="!patientdetailsdata?.name">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group" *ngIf="patientdetailsdata?.createdAt || createdAt">
                                <label for="">REG. Date</label>
                                <!-- <input class="form-control" disabled *ngIf="patientdetailsdata?.createdAt" [value]="patientdetailsdata?.createdAt | date:'dd-MM-yyyy'"> -->
                                <input class="form-control" style="font-size: 13px;" *ngIf="createdAt"
                                    [value]="createdAt | date:'dd-MM-yyyy HH:mm'">
                            </div>
                            <div class="form-group">
                                <label>Gender</label>
                                <input class="form-control" [value]="patientdetailsdata?.gender"
                                    *ngIf="patientdetailsdata?.gender">
                                <input class="form-control" *ngIf="!patientdetailsdata?.gender">
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="qr-code border-success">
                                <label>Bar Code</label>
                                <ngx-barcode [bc-value]="barCodeValue" [bc-display-value]="true" *ngIf="barCodeValue">
                                </ngx-barcode>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="qr-code border-success">
                                        <label>QR Code</label>
                                        <!-- <qrcode 
                                        [qrdata]="barCodeValue" [width]="150"  [errorCorrectionLevel]="'M'" [elementType]="'svg'" *ngIf="barCodeValue"
                                        ></qrcode> -->
                                        <ngx-qrcode [elementType]="'svg'" [value]="barCodeValue" cssClass="aclass"
                                            [width]="120" errorCorrectionLevel="L">
                                        </ngx-qrcode>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <img src="../../../assets/PreviaLogo.png" class="img-responsive img-fluid">
                                    <!-- <img [src]="sanitizer.bypassSecurityTrustUrl('/' + cardModel[r.content].value)" /> -->
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label>DOB</label>
                                <input class="form-control" [value]="patientdetailsdata?.DOB"
                                    *ngIf="patientdetailsdata?.DOB">
                                <input class="form-control" *ngIf="!patientdetailsdata?.DOB">
                            </div>
                        </div>
                        <div class="col-md-1">
                            <div class="form-group">
                                <label>Age</label>
                                <input class="form-control" [value]="age">
                                <!-- <input class="form-control" *ngIf="!patientdetailsdata?.name"> -->
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Mobile</label>
                                <input class="form-control" [value]="patientdetailsdata?.mobileNumber"
                                    *ngIf="patientdetailsdata?.mobileNumber">
                                <input class="form-control" *ngIf="!patientdetailsdata?.mobileNumber">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Email</label>
                                <input class="form-control" [value]="patientdetailsdata?.emailAddress"
                                    *ngIf="patientdetailsdata?.emailAddress">
                                <input class="form-control" *ngIf="!patientdetailsdata?.emailAddress">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Proof Details</label>
                                <div class="input-flex">
                                    <input class="form-control borderRight" [value]="patientdetailsdata?.proofType"
                                    *ngIf="patientdetailsdata?.proofType">
                                     <input class="form-control borderRight" *ngIf="!patientdetailsdata?.proofType">
                                     <input class="form-control" [value]="patientdetailsdata?.proofValue"
                                    *ngIf="patientdetailsdata?.proofValue">
                                <input class="form-control" *ngIf="!patientdetailsdata?.proofValue">
                                </div>
                                <!-- <div *ngIf="submitted && f.aadhaar.errors" class="invalid-feedback">
                                    <div *ngIf="f.aadhaar.errors.required" >Please enter valid  Aadhar</div>
                                </div> -->
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Aaadhar</label>
                                <input class="form-control" [value]="patientdetailsdata?.aadhaar"
                                    *ngIf="patientdetailsdata?.aadhaar">
                                <input class="form-control" *ngIf="!patientdetailsdata?.aadhaar">
                            </div>
                        </div>

                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Economic Status</label>
                                <input class="form-control" [value]="patientdetailsdata?.economicStatus"
                                    *ngIf="patientdetailsdata?.economicStatus">
                                <input class="form-control" *ngIf="!patientdetailsdata?.economicStatus">
                            </div>
                        </div>

                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Occupation</label>
                                <input class="form-control" [value]="patientdetailsdata?.occupation"
                                    *ngIf="patientdetailsdata?.occupation">
                                <input class="form-control" *ngIf="!patientdetailsdata?.occupation">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>Address</label>
                                <input class="form-control" [value]="patientdetailsdata?.address"
                                    *ngIf="patientdetailsdata?.address">
                                <input class="form-control" *ngIf="!patientdetailsdata?.address">
                            </div>
                        </div>

                        <div class="col-md-2">
                            <div class="form-group">
                                <label>City</label>
                                <input class="form-control" [value]="patientdetailsdata?.city"
                                    *ngIf="patientdetailsdata?.city">
                                <input class="form-control" *ngIf="!patientdetailsdata?.city">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>State</label>
                                <input class="form-control" [value]="patientdetailsdata?.state"
                                    *ngIf="patientdetailsdata?.state">
                                <input class="form-control" *ngIf="!patientdetailsdata?.state">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Habits</label>
                                <textarea type="text" class="form-control" [value]="patientdetailsdata?.habits"
                                    *ngIf="patientdetailsdata?.habits"></textarea>
                                <textarea type="text" class="form-control"
                                    *ngIf="!patientdetailsdata?.habits"></textarea>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>LifeStyle</label>
                                <textarea type="text" class="form-control" [value]="patientdetailsdata?.lifeStyle"
                                    *ngIf="patientdetailsdata?.lifeStyle"></textarea>
                                <textarea type="text" class="form-control"
                                    *ngIf="!patientdetailsdata?.lifeStyle"></textarea>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="print-questionnaire" class="d-none">
    <div class="card ">
        <div class="">
            <h3 class="text-center">Questionnaire - {{patientdetailsdata?.pid}}</h3>
            <div class=" m-2 p-3">
                <!-- *ngFor="let item of questionariesDetails ; let i=index" -->
                <div>
                    <table class="table table-bordered">
                        <tr>
                            <th>S.No</th>
                            <th class="questionWidth">Question</th>
                            <th>Response</th>
                            <th>Code</th>
                        </tr>
                        <ng-template #rowTemplateOutlet1 let-index="index" let-index2="index2" let-item="item"
                            let-Question="Question">
                            <tr class="tableheader qnHeading">
                                <!--  -->
                                <td colspan="5" style="background:#ddd;text-align:center;font-weight: bold;"
                                    *ngIf="index == 0">
                                    {{item.name}}
                                </td>
                            </tr>

                            <tr>
                                <td>{{index+1}}</td>
                                <td>{{Question.question}}</td>
                                <td>
                                    <span class="row"
                                        *ngIf="Question?.type === 'input' || Question?.type === 'textArea' || Question?.type === 'dropdown' || Question?.type === 'time'">
                                        <input type="text" style="border-width: 0px 0px 1px;
                                        border-style: dashed;
                                        border-color: black;
                                        margin-left: 6px;
                                        "><span style="font-size: 12px;">{{Question?.units}}</span>
                                    </span>

                                    <span *ngIf="Question?.type === 'paragraph'">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                    </span>
                                    <span *ngIf="Question?.type === 'radio'">
                                        1.Yes &nbsp;&nbsp;
                                        2.No
                                    </span>
                                    <span *ngIf="Question?.type === 'options'">
                                        <!-- 1.Yes &nbsp;&nbsp;
                                        2.No -->
                                        <p *ngFor="let answers of Question?.possibleAnswers ; let indexvalue=index">
                                            {{indexvalue+1}}.{{answers}} </p>
                                    </span>
                                    <span *ngIf="Question?.type === 'checkbox'">
                                        <div class="d-flex" style="align-items: center; margin-bottom: 10px;"
                                            *ngFor="let answers of Question?.possibleAnswers">
                                            <input type="checkbox">
                                            <span style="padding-left: 8px;">{{answers}}</span>
                                        </div>
                                    </span>
                                    <span *ngIf="Question?.type === 'numeric'">
                                        <div>
                                            <div style="display: flex;">
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <span>{{Question?.units}}</span>
                                            </div>
                                        </div>
                                    </span>

                                    <span *ngIf="Question?.type === 'date'"
                                        style="display: flex;justify-content: space-evenly;">
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">dd</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">mm</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">yyyy</div>
                                        </div>
                                    </span>
                                </td>
                                <td style="width: 15%;">{{Question.code}}</td>
                            </tr>
                            <tr *ngFor="let subQuestion of Question?.subQuestions; let ind=index;">
                                <td>{{index+1}}.{{ind+1}}</td>
                                <td>{{subQuestion?.question}}</td>

                                <td>
                                    <span class="row"
                                        *ngIf="subQuestion?.type === 'input' || subQuestion?.type === 'textArea' || subQuestion?.type === 'dropdown' || subQuestion?.type === 'time'">
                                        <input type="text" style="border-width: 0px 0px 1px;
                                        border-style: dashed;
                                        border-color: black;
                                        margin-left: 6px;
                                        "><span style="font-size: 12px;">{{subQuestion?.units}}</span>
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'radio'">
                                        1.Yes &nbsp;&nbsp;
                                        2.No
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'options'">
                                        <!-- 1.Yes &nbsp;&nbsp;
                                        2.No -->
                                        <p *ngFor="let answers of subQuestion?.possibleAnswers ; let indexvalue=index">
                                            {{indexvalue+1}}.{{answers}} </p>
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'checkbox'">
                                        <div class="d-flex" style="align-items: center; margin-bottom: 10px;"
                                            *ngFor="let answers of subQuestion?.possibleAnswers">
                                            <input type="checkbox">
                                            <span style="padding-left: 8px;">{{answers}}</span>
                                        </div>
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'numeric'">
                                        <div>
                                            <div style="display: flex;">
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 15px;"></p>
                                                <span>{{subQuestion?.units}}</span>
                                            </div>
                                        </div>
                                    </span>
                                    <span *ngIf="Question?.type === 'paragraph'">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                        <input type="text"
                                            style="border-width: 0px 0px 1px;border-style: dashed;border-color: black;margin-right: 9px; display: block0;">
                                    </span>
                                    <span *ngIf="subQuestion?.type === 'date'"
                                        style="display: flex;justify-content: space-evenly;">
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">dd</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">mm</div>
                                        </div>
                                        <div>
                                            <div style="display: flex;justify-content: center;">
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                                <p style="border: solid 1px #ccc;padding: 10px;"></p>
                                            </div>
                                            <div style="text-align: center;">yyyy</div>
                                        </div>
                                    </span>
                                </td>
                                <td style="width: 15%;">{{subQuestion?.code}}</td>
                            </tr>
                        </ng-template>

                        <ng-container *ngFor="let item of questionariesDetails;let inde=index;">
                            <ng-container *ngFor="let Question of item?.questions; let i=index;">
                                <ng-container
                                    *ngTemplateOutlet="rowTemplateOutlet1; context:{item: item, Question: Question, index: i,index2:inde}">
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </table>
                </div>
            </div>
        </div>
    </div>

</div>

<div id="print-barcode" class="d-none" >
    <table >
        <tbody>
            <tr>
                <td ><ngx-barcode [bc-value]="value" [bc-display-value]="true"></ngx-barcode></td>
                <td ><ngx-barcode [bc-value]="value" [bc-display-value]="true"></ngx-barcode></td>
            </tr>
        </tbody>
        
    </table>

</div>

<ng-template #myDailog>
    <mat-dialog-content>
        <div class="modal-heading-div">
            <h2 matDialogTitle class="mat">Update Test Values</h2>
            <button mat-button matDialogClose color="primary" class="cancel-button">
                <i class="fa fa-times"></i>
            </button>
        </div>
        <mat-card>
            <form [formGroup]="updateTestsForm" (ngSubmit)="updateTestsDetails()">
                <div class="form-group">
                    <label for="">Test Name</label>
                    <!-- <input class="form-ontrol" [disabled] formControlName="test"> -->
                    <select disabled formControlName="test" class="form-control">
                        <option *ngFor="let item of testsDetails" [value]="item._id">{{item.name}}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="">Value</label>
                    <input class="form-control" formControlName="value">
                </div>
                <div class="form-group">
                    <label for="">Comment</label>
                    <input class="form-control" formControlName="comment">
                </div>
                <div>
                    <button class="btn" type="submit">Update</button>
                </div>
            </form>
        </mat-card>
    </mat-dialog-content>
</ng-template>


<ng-template #content let-modal>
    <!-- <div></div> -->
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Report Template: <b>{{currentItem.test.name}}</b></h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <!-- *ngIf="!docViweEditorFlag" -->
        <div>
            <!-- <div><button></button></div> -->
            <!-- <ngx-doc-viewer [url]="doc" viewer="google" style="width:100%;height:50vh;"></ngx-doc-viewer> -->
            <div class="text-right">
                <!-- <button class="btn btn-md mb-4" (click)="toggleDisabled()">
                    {{ isDisabled ? 'Edit Template' : 'Cancel' }}
                </button> -->
            </div>
            <div class="col-md-12">
                <div class="border p-3">
                    <p class="mb-0" [innerHtml]="templateViewContent"></p>
                </div>
                <!-- data="templateViewContent" (change)="changedTemplateContent($event)"-->
                <!-- <ckeditor [editor]="Editor" [(ngModel)]="templateViewContent" [disabled]="isDisabled">
                </ckeditor> -->
            </div>
        </div>
        <!-- <div *ngIf="docViweEditorFlag">
            <h6>Edit section</h6>
        </div> -->
    </div>
    <div class="modal-footer">
        <!-- (click)="editDocView()"-->
        <!-- <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')"> Cancel</button> -->
        <!-- <button type="button" class="btn btn-outline-dark" (click)="saveTemplateEditData()">Save changes</button> -->
    </div>
</ng-template>